---
permalink: flexcache-writeback/flexcache-write-back-guidelines.html 
sidebar: sidebar 
keywords: tr-4743, flexcache writeback, flexcache write-back, flexcache, write-back, write back, guidelines, best practices, performance, ontap tr, netapp tr 
summary: Siga estas directrices para garantizar un rendimiento óptimo cuando utilice la reescritura de FlexCache. 
---
= Directrices de reescritura de ONTAP FlexCache
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
La escritura diferida de FlexCache implica muchas interacciones complejas entre el origen y las cachés. Para un rendimiento óptimo, debe asegurarse de que su entorno siga estas directrices. Estas directrices se basan en la última versión principal de ONTAP (ONTAP 9.17.1) disponible en el momento de la creación del contenido.

Como práctica recomendada, pruebe su carga de trabajo de producción en un entorno no productivo. Esto es incluso más importante si va a implementar la devolución de datos de FlexCache fuera de estas directrices.

Las siguientes directrices han sido bien probadas internamente en NetApp. Es *_strong_* recomendable que te quedes dentro de ellos. Si no lo hace, podría ocurrir un comportamiento inesperado.

* En ONTAP 9.17.1P1 se introdujeron mejoras significativas para la escritura diferida de FlexCache . Se recomienda *encarecidamente* que ejecute la versión recomendada actual después de la 9.17.1P1 tanto en el clúster de origen como en el de caché. Si no puede ejecutar la línea de código 9.17.1, la última versión P de 9.16.1 es la siguiente versión sugerida. ONTAP 9.15.1 no tiene todas las correcciones y mejoras necesarias para la escritura diferida de FlexCache y no se recomienda para cargas de trabajo de producción.
* En su iteración actual, los cachés de retroescritura FlexCache deben configurarse con un único componente para todo el volumen FlexCache. Los FlexCaches de varios componentes pueden provocar expulsiones no deseadas de datos de la caché.
* Las pruebas se han realizado con archivos de menos de 100 GB y tiempos de ida y vuelta de la WAN entre la caché y el origen que no superan los 200 ms. Cualquier carga de trabajo que exceda estos límites podría resultar en características de rendimiento inesperadas.
* Al escribir en flujos de datos alternativos de SMB, el archivo principal se expulsa de la caché. Todos los datos desfasados del archivo principal deben vaciarse en el origen antes de poder realizar otras operaciones en ese archivo. El flujo de datos alternativo también se reenvía al origen.
* Cambiar el nombre de un archivo hace que el archivo sea expulsado de la caché. Todos los datos desfasados del archivo deben vaciarse en el origen antes de poder realizar otras operaciones en ese archivo.
* En este momento, los únicos atributos que se pueden cambiar o configurar en un archivo del volumen FlexCache con la función de escritura-retroescritura habilitada son:
+
** Fecha/hora
** Bits de modo
** ACL NT
** Propietario
** Grupo
** Tamaño
+
Cualquier otro atributo que se modifique o defina se reenviará al origen, lo que podría provocar el desalojo del archivo de la caché. Si necesita cambiar o establecer otros atributos en la memoria caché, pida a su equipo de cuentas que abra un PVR.



* Las instantáneas tomadas en origen provocan la recuperación de todos los datos desfasados pendientes de cada caché con retroescritura habilitada asociada con ese volumen de origen. Esto puede requerir varios reintentos de la operación si hay una actividad de reescritura significativa en curso, ya que los expulsos de esos archivos desfasados pueden tardar algún tiempo.
* Los bloqueos oportunistas (Oplocks) de SMB para escrituras no son compatibles con volúmenes FlexCache con escritura diferida habilitada.
* El origen debe permanecer por debajo del 80% completo. A los volúmenes de caché no se les otorgan delegaciones de bloqueo exclusivo si no queda al menos un 20% de espacio en el volumen de origen. En esta situación, las llamadas a una caché con reescritura activada se reenvían al origen. Esto ayuda a evitar que se quede sin espacio en el origen, lo que provocaría que los datos desfasados queden huérfanos en una caché con retroescritura habilitada.
* Las redes intercluster de bajo ancho de banda y/o con pérdidas pueden tener un efecto negativo significativo en el rendimiento de escritura diferida de FlexCache . Aunque no existe un requisito de ancho de banda específico, ya que depende en gran medida de su carga de trabajo, se recomienda *encarecidamente* que garantice el buen funcionamiento del enlace entre clústeres entre la(s) caché(s) y el origen.

